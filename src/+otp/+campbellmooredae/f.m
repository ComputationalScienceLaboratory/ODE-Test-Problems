function dy = f(t, y, r, rho)

dy = [-1.0./sqrt(y(1,:).^2+y(2,:).^2).*(y(8,:).*sqrt(y(1,:).^2+y(2,:).^2)+y(5,:).*sqrt(y(1,:).^2+y(2,:).^2)-y(6,:).*cos(t).*sqrt(y(1,:).^2+y(2,:).^2)+y(3,:).*sin(t).*sqrt(y(1,:).^2+y(2,:).^2)-y(7,:).*y(1,:).*sqrt(y(1,:).^2+y(2,:).^2).*2.0+y(7,:).*r.*y(1,:).*2.0);
    1.0./sqrt(y(1,:).^2+y(2,:).^2).*(-y(9,:).*sqrt(y(1,:).^2+y(2,:).^2)+y(4,:).*sqrt(y(1,:).^2+y(2,:).^2)+y(3,:).*cos(t).*sqrt(y(1,:).^2+y(2,:).^2)+y(6,:).*sin(t).*sqrt(y(1,:).^2+y(2,:).^2)+y(7,:).*y(2,:).*sqrt(y(1,:).^2+y(2,:).^2).*2.0-y(7,:).*r.*y(2,:).*2.0);
    -y(10,:)-y(3,:)+y(7,:).*y(3,:).*2.0;
    r.*sqrt(y(1,:).^2+y(2,:).^2).*-2.0+r.^2-rho.^2+y(1,:).^2+y(2,:).^2+y(3,:).^2;
    1.0./sqrt(y(1,:).^2+y(2,:).^2).*(y(4,:).*y(1,:).*sqrt(y(1,:).^2+y(2,:).^2)+y(5,:).*y(2,:).*sqrt(y(1,:).^2+y(2,:).^2)+y(6,:).*y(3,:).*sqrt(y(1,:).^2+y(2,:).^2)-r.*y(4,:).*y(1,:)-r.*y(5,:).*y(2,:)).*2.0;
    1.0./(y(1,:).^2+y(2,:).^2).^(3.0./2.0).*(y(4,:).^2.*(y(1,:).^2+y(2,:).^2).^(3.0./2.0)+y(5,:).^2.*(y(1,:).^2+y(2,:).^2).^(3.0./2.0)+y(6,:).^2.*(y(1,:).^2+y(2,:).^2).^(3.0./2.0)-r.*y(4,:).^2.*y(2,:).^2-r.*y(5,:).^2.*y(1,:).^2+y(8,:).*y(1,:).*(y(1,:).^2+y(2,:).^2).^(3.0./2.0)+y(9,:).*y(2,:).*(y(1,:).^2+y(2,:).^2).^(3.0./2.0)+y(10,:).*y(3,:).*(y(1,:).^2+y(2,:).^2).^(3.0./2.0)-y(8,:).*r.*y(1,:).^3-y(9,:).*r.*y(2,:).^3-y(8,:).*r.*y(1,:).*y(2,:).^2-y(9,:).*r.*y(1,:).^2.*y(2,:)+r.*y(4,:).*y(5,:).*y(1,:).*y(2,:).*2.0).*2.0;
    y(8,:);y(10,:);-y(4,:);-y(6,:)];


end
