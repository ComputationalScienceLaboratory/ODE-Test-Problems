function du = f(~, u, theta, alpha, nu, rho, ~, Dx, D3x, ~, ~)

u_x = Dx*u;
du = alpha*(theta*(Dx*(u.^2)) ...
    + 2*(1 - theta)*(u.*u_x)) ...
    + rho*u_x ...
    + nu*(D3x*u);

end